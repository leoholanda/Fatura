<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:p="http://primefaces.org/ui" xmlns:jsf="http://xmlns.jcp.org/jsf">

	<div class="ui-g-12 ui-sm-12 ui-lg-6">

		<div class="card">
			<h1 class="Gray">
				<span>Faturas</span>
			</h1>

			<p:tabView value="#{faturaMB.faturasDoBeneficiario}" var="fatura"
				dynamic="true" cache="true" scrollable="true">
				<p:tab title="#{fatura.mesAnoDaFatura}">
				
					<div class="MarBot20" style="text-align: center;">
						<p:outputLabel value="#{fatura.mesAnoDaFatura}" styleClass="BoldGray" />
					</div>
					
					<p:outputLabel value="Fatura: #{fatura.id}" title="Código da Fatura" 
			              		rendered="#{!seguranca.usuarioLogado.enabled}" styleClass="MarBot20"/>


					<div class="MarBot20">
						<div style="text-align: left;" class="Fleft">
							<p:commandButton value="#{fatura.deParaStatus}" styleClass="Fs14 #{fatura.exibeStatusDaFatura}" />
							
							<p:commandButton value="#{fatura.id}" action="#{faturaMB.redirecionaParaFatura(fatura.id)}" 
								update="@this" process="@this" title="Abrir fatura" styleClass="MarLeft10"
								rendered="#{seguranca.usuarioLogado.enabled}"/>	
								
							<p:outputLabel value="#{fatura.dataPagamento.time}"
								styleClass="Green Fs14"
								rendered="#{fatura.pago || fatura.parcelado || fatura.fechado}">
								<f:convertDateTime pattern="dd/MM/yyyy" />
							</p:outputLabel>	

			              	   
						</div>

						<div style="text-align: right;">
							<p:outputLabel value="Vencimento: "
								styleClass="Red Fs15 MarTop20" />
							<p:outputLabel value="#{fatura.vencimento}" styleClass="Red Fs15">
								<f:convertDateTime pattern="dd/MM/yyyy" />
							</p:outputLabel>
						</div>
					</div>
					

					<!-- Detalha das parcelas -->

					<div jsf:rendered="#{fatura.parcelada}">
						<ui:repeat value="#{fatura.faturaParcelada}" var="parcela">
							<ul class="task-list">
								<li><span class="task-name"> <p:outputLabel
											value="Parcela #{parcela.numeroDaParcela}" styleClass="Green"
											rendered="#{!parcela.pendente}" />
								</span> <span class="task-name"><p:outputLabel
											value="Parcela #{parcela.numeroDaParcela}" styleClass="Red"
											rendered="#{parcela.pendente}" /></span> <span
									class="task-name Gray" style="margin-left: 10px;">#{parcela.converterDataVencimento}</span>

									<i class="task-name Green fa fa-check"
									jsf:rendered="#{!parcela.pendente}" style="margin-left: 10px;" />

									<p:commandButton value="#{parcela.converterValorTotal}"
										style="cursor: text; border-color: #FB8C00;  background-color: #FB8C00; width: 100px;"
										update="@this" process="@this" /></li>
							</ul>
						</ui:repeat>
					</div>
					<p:spacer width="20" rendered="#{fatura.parcelada}" />


					<div jsf:rendered="#{!fatura.parcelada}">
						<!-- Titular-->
						<ul class="task-list"
							jsf:rendered="#{not empty fatura.plano.beneficiario.dependentes}">
							<li><span class="task-name">#{fatura.plano.beneficiario.nomeComIniciaisMaiuscula}</span>
								
								<p:commandButton
									value="#{fatura.plano.beneficiario.converterValor}"
									styleClass="FaturaDescricao"
									style="width: 100px;"
									update="@this" process="@this" />
								<br /><span class="task-name Gray">Titular</span>
							</li>
						</ul>

						<!-- Detalha o(s) dependente(s)-->
						<ui:repeat value="#{fatura.plano.beneficiario.dependentes}"
							var="dependente">
							<ul class="task-list">
								<li><span class="task-name">#{dependente.nomeComIniciaisMaiuscula}</span>

									<p:commandButton value="#{dependente.converterValor}"
										styleClass="FaturaDescricao"
										style="width: 100px;"
										update="@this" process="@this" /><br /> 
									<span class="task-name Gray">#{dependente.tipoDependencia.descricao}</span>
								</li>
							</ul>
						</ui:repeat>
						<br />

						<ul class="task-list">
							<li jsf:rendered="#{fatura.plano.beneficiario.temPlanoDeSaude}"><span
								class="task-name">TOTAL PLANO DE SAÚDE</span> <p:commandButton styleClass="FaturaDescricao"
									value="#{fatura.converterValorPlano}"
									style="width: 100px;"
									update="@this" process="@this" /></li>
									
							<li
								jsf:rendered="#{!fatura.plano.beneficiario.consignado and fatura.plano.beneficiario.temPlanoDeSaude}">
								<span class="task-name">MENSALIDADE</span> <p:commandButton styleClass="FaturaDescricao"
									value="#{fatura.converterMensalidade}"
									style="width: 100px;"
									update="@this" process="@this" />
							</li>
							
							<li jsf:rendered="#{fatura.servicos}"><span
								class="task-name">SERVIÇOS</span> <p:commandButton
									value="#{fatura.converterValorServicos}" styleClass="FaturaDescricao"
									style="width: 100px;"
									update="@this" process="@this" /></li>
									
							<p:spacer width="10" />

							<li jsf:rendered="#{!faturaMB.fatura.multaAplicada}"><span
								class="task-name BoldGray">VALOR TOTAL GERADO</span> <p:commandButton
									value="#{fatura.converterValorTotalGerado}" styleClass="ButtonTurquoise"
									style="width: 100px;"
									update="@this" process="@this" /></li>

							<li
								jsf:rendered="#{fatura.temResiduoDaFaturaAnterior}">

								<span jsf:rendered="#{fatura.debitoFaturaAnterior}"
								class="task-name FontBold Red">DÉBITO (FATURA ANTERIOR)</span> <span
								jsf:rendered="#{!fatura.debitoFaturaAnterior}"
								class="task-name FontBold Blue">CRÉDITO (FATURA ANTERIOR)</span>

								<p:commandButton value="#{fatura.converterResiduoDescontado}"
									rendered="#{fatura.debitoFaturaAnterior}"
									style="cursor: text; border-color: #E53935; background-color: #E53935; width: 100px;"
									update="@this" process="@this" /> 
									
								<p:commandButton
									value="#{fatura.converterResiduoDescontado}"
									rendered="#{!fatura.debitoFaturaAnterior}"
									style="cursor: text; border-color: #03A9F4; background-color: #03A9F4; width: 100px;"
									update="@this" process="@this" />
							</li>
						</ul>
						<br />

						<ul class="task-list" jsf:rendered="#{fatura.multaAplicada}">
							<li><span class="task-name Pendente">MULTA</span> <p:commandButton styleClass="Pendente"
									value="#{fatura.multaPorAtraso}"
									style="width: 100px;"
									update="@this" process="@this" /></li>

							<li><span class="task-name Pendente">JUROS</span> <p:commandButton styleClass="Pendente"
									value="#{fatura.jurosAoDia}"
									style="width: 100px;"
									update="@this" process="@this" /></li>
						</ul>
					</div>
					<br />

					<ul class="task-list">
						<li><span class="task-name FontBold Fs14">TOTAL
								À PAGAR</span> <p:commandButton value="#{fatura.converterValorTotal}" styleClass="TotalPagar"
								style="width: 100px;"
								update="@this" process="@this" /></li>
					</ul>

					<ul class="task-list" jsf:rendered="#{fatura.valorPago ne null}">
						<li><span class="task-name Green Fs14">VALOR
								PAGO</span> <p:commandButton value="#{fatura.converterValorPago}" styleClass="Pago"
								style="width: 100px;"
								update="@this" process="@this" /></li>
					</ul>
					<br />

					<ul class="task-list" jsf:rendered="#{fatura.residuoParaProximaFatura}">
						<li><span class="task-name Red"
							jsf:rendered="#{fatura.debitoDeResiduo}">DÉBITO PARA PRÓXIMA
								FATURA</span> 
								
							<span class="task-name Blue"
							jsf:rendered="#{!fatura.debitoDeResiduo}">CRÉDITO
								PARA PRÓXIMA FATURA</span> 
								
							<p:commandButton
								value="#{fatura.converterValorDoResiduo}"
								rendered="#{fatura.debitoDeResiduo}" styleClass="Atrasado"
								style="width: 100px;"
								update="@this" process="@this" /> 
								
								<p:commandButton styleClass="Fechado"
								value="#{fatura.converterValorDoResiduo}"
								rendered="#{!fatura.debitoDeResiduo}"
								style="width: 100px;"
								update="@this" process="@this" /></li>
					</ul>

				</p:tab>
			</p:tabView>
		</div>
	</div>
	
	<!-- Dialog pagamento  -->
	<ui:include src="/pages/protected/fatura/dialog-pagamento-fatura.xhtml" />

</ui:composition>